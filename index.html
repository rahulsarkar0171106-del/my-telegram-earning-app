<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ржЖржорж╛рж░ ржЖрж░рзНржирж┐ржВ ржЕрзНржпрж╛ржк</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        /* ... (ржЖржкржирж╛рж░ ржЖржЧрзЗрж░ CSS ржХрзЛржб ржПржЦрж╛ржирзЗ ржерж╛ржХржмрзЗ) ... */
        /*
        ржпржжрж┐ ржЖржкржирж┐ рж╕ржорзНржкрзВрж░рзНржг CSS ржЪрж╛ржи, рждрж╛рж╣рж▓рзЗ ржЖржЧрзЗрж░ ржжрзЗржУрзЯрж╛ рж╕ржорзНржкрзВрж░рзНржг ржХрзЛржбржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред
        ржЖржорж┐ ржзрж░рзЗ ржирж┐ржЪрзНржЫрж┐ ржЖржкржирж┐ рж╢рзБржзрзБ JS ржЕржВрж╢ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржЪрж╛ржиред 
        */

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
            background-color: #0d0d10 !important;
            color: #f0f0f0 !important;
            margin: 0 !important;
            padding: 20px !important;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
        }

        .balance-card {
            background: linear-gradient(135deg, #4f31c7, #2c1a85) !important; 
            padding: 25px !important;
            border-radius: 15px !important;
            text-align: center !important;
            margin-bottom: 25px !important;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5) !important;
        }
        /* ... (ржмрж╛ржХрж┐ рж╕ржм CSS рж╕рзНржЯрж╛ржЗрж▓) ... */
        .ad-viewer-overlay {
            position: fixed !important;
            top: 0 !important; 
            left: 0 !important; 
            width: 100% !important;
            height: 100vh !important;
            z-index: 9999 !important; 
            background-color: #000000 !important;
            display: none; 
            flex-direction: column;
            justify-content: flex-start; 
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="balance-card">
            <h2>ржЖржорж╛рж░ ржмрж░рзНрждржорж╛ржи ржмрзНржпрж╛рж▓рзЗржирзНрж╕:</h2>
            <p id="current-balance">рзлрзж.рзжрзж Taka ЁЯТ░</p>
        </div>
        <div class="task-grid">
            <div class="task-card" id="ad-view-card">
                <h3>ржжрзИржирж┐ржХ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛</h3>
                <p id="ad-count">0 / 10</p>
                <button id="ad-button" onclick="startAdView()">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи (рзл ржЯрж╛ржХрж╛)</button> 
            </div>
            <div class="task-card" id="referral-card">
                <h3>ржорзЛржЯ рж░рзЗржлрж╛рж░</h3>
                <p id="referral-count">0</p>
                <button onclick="shareReferral()">ржмржирзНржзрзБржжрзЗрж░ рж░рзЗржлрж╛рж░ ржХрж░рзБржи</button>
            </div>
        </div>
        <div class="footer-nav">
            <button onclick="startWithdrawal()">ржЯрж╛ржХрж╛ ржЙржЗржержбрзНрж░ ржХрж░рзБржи</button> 
        </div>
    </div>
    
    <div id="ad-viewer" class="ad-viewer-overlay">
        <div class="ad-header">
            ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╣ржЪрзНржЫрзЗ... (<span id="countdown-timer">20</span>s)
        </div>
        <iframe id="ad-frame" src="" frameborder="0"></iframe> 
        <button id="ad-done-button" onclick="adFinished()" style="display:none;">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ ржХрж░рзБржи ржПржмржВ рж╣рзЛржорзЗ ржлрж┐рж░рзБржи</button>
    </div>

    <script>
        // ржбрзЗржЯрж╛ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬрзЗрж╢ржи (ржбрж┐ржлрж▓рзНржЯ ржорж╛ржи)
        let userBalance = 50.00;
        let adsWatched = 0;
        let totalReferrals = 0; 
        const totalAds = 10;
        const rewardPerAd = 5.00; 
        const minimumWithdrawal = 500.00; 

        // DOM ржПрж▓рж┐ржорзЗржирзНржЯрж╕
        let countdownInterval;
        const adViewer = document.getElementById('ad-viewer');
        const adFrame = document.getElementById('ad-frame');
        const adButton = document.getElementById('ad-button');
        const countdownTimer = document.getElementById('countdown-timer');
        const adDoneButton = document.getElementById('ad-done-button');
        const referralCountElement = document.getElementById('referral-count'); 

        // тнР ржлрж╛ржВрж╢ржи рзз: рж╕рзНржЯрзЛрж░рзЗржЬ ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рж╛ тнР
        function loadData() {
            // ржпржжрж┐ Telegram WebApp ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ, рждржмрзЗ рждрж╛рж░ рж╕рзНржЯрзЛрж░рзЗржЬ ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рзЛ
            if (window.Telegram && window.Telegram.WebApp) {
                const storedData = window.Telegram.WebApp.WebAppData;
                
                // ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ WebApp.CloudStorage ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржнрж╛рж▓рзЛ рж╣рждрзЛ, 
                // ржХрж┐ржирзНрждрзБ рж╕рж╣ржЬрзЗ Local Storage-ржПрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ ржПржЗ ржкржжрзНржзрждрж┐рждрзЗ ржпрж╛ржЪрзНржЫрж┐ред
                
                // ржХрж┐ржирзНрждрзБ Telegram WebApp Local Storage-ржПрж░ ржЬржирзНржп ржЖржорж░рж╛ рж╕рж╛ржзрж╛рж░ржг window.localStorage ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм
                // ржХрж╛рж░ржг CloudStorage-ржПрж░ ржЬржирзНржп Async/Await ржжрж░ржХрж╛рж░ред
                const storedBalance = localStorage.getItem('userBalance');
                const storedAds = localStorage.getItem('adsWatched');

                if (storedBalance !== null) {
                    userBalance = parseFloat(storedBalance);
                }
                if (storedAds !== null) {
                    adsWatched = parseInt(storedAds);
                }
            }
        }
        
        // тнР ржлрж╛ржВрж╢ржи рзи: ржбрзЗржЯрж╛ рж╕рзЗржн ржХрж░рж╛ тнР
        function saveData() {
            if (window.Telegram && window.Telegram.WebApp) {
                localStorage.setItem('userBalance', userBalance.toFixed(2));
                localStorage.setItem('adsWatched', adsWatched.toString());
            }
            // Note: CloudStorage is generally better for TWA but requires more complex async code.
        }


        // ржпржЦржи ржЕрзНржпрж╛ржк рж▓рзЛржб рж╣ржмрзЗ
        window.onload = function() {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.MainButton.hide();
                
                if (window.Telegram.WebApp.colorScheme === 'dark') {
                    document.body.style.backgroundColor = '#0d0d10';
                    document.body.style.color = '#f0f0f0';
                }
            }
            
            // тнР рж▓рзЛржб ржбрзЗржЯрж╛ ржХрж▓ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ тнР
            loadData(); 
            
            updateUI();
            showWelcomeNotice(); 
        };
        
        // UI (User Interface) ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржлрж╛ржВрж╢ржи
        function updateUI() {
            document.getElementById('current-balance').innerText = userBalance.toFixed(2) + ' Taka ЁЯТ░';
            document.getElementById('ad-count').innerText = `${adsWatched} / ${totalAds}`;
            referralCountElement.innerText = totalReferrals; 
            
            if (adsWatched >= totalAds) {
                adButton.disabled = true;
                adButton.innerText = 'ржЖржЬржХрзЗрж░ ржЯрж╛рж╕рзНржХ рж╢рзЗрж╖';
            } else {
                adButton.disabled = false;
                adButton.innerText = 'ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи (рзл ржЯрж╛ржХрж╛)';
            }
        }

        function showWelcomeNotice() {
            const noticeTitle = 'рж╕рзНржмрж╛ржЧрждржо! ЁЯФе';
            const noticeMessage = 
                'ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо, рж╕рждрждрж╛рж░ рж╕рж╛ржерзЗ ржкрзЗржорзЗржирзНржЯ ржХрж░ржЫрж┐ред ржирж┐ржпрж╝ржо ржорзЗржирзЗ ржХрж╛ржЬ ржХрж░рж▓рзЗ рззрзжрзж% ржкрзЗржорзЗржирзНржЯ ржкрж╛ржмрзЗржи ржЗржирж╢рж╛ржЖрж▓рзНрж▓рж╛рж╣! ЁЯФе\n\n' +
                'тАв ржЬржпрж╝рзЗржирж┐ржВ ржмрзЛржирж╛рж╕: рзлрзж ржЯрж╛ржХрж╛\n' +
                'тАв ржкрзНрж░рждрж┐ рж░рзЗржлрж╛рж░рзЗ: рзйрзж ржЯрж╛ржХрж╛\n' +
                'тАв ржкрзНрж░рждрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржирзЗ: рзл ржЯрж╛ржХрж╛\n' + 
                'тАв ржкрзНрж░рждрж┐ржжрж┐ржи рззрзж ржЯрж╛ ржХрж░рзЗ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛рж░ рж╕рзБржпрзЛржЧ\n' +
                '\n' +
                'тЪбя╕П ржПржЗ рж╕рж╛ржЗржЯрзЗ ржХрзЛржирзЛ ржЗржиржнрзЗрж╕рзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗ ржирж╛ рж╕ржорзНржкрзВрж░рзНржг ржлрзНрж░рж┐рждрзЗ ржЗржиржХрж╛ржо ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред ржзржирзНржпржмрж╛ржжред';
            
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.showPopup({
                    title: noticeTitle,
                    message: noticeMessage,
                    buttons: [{ text: 'ржмрзБржЭрзЗржЫрж┐', id: 'ok' }]
                });
            } else {
                alert(noticeTitle + '\n\n' + noticeMessage);
            }
        }

        // ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛рж░ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ рж╢рзБрж░рзБ ржХрж░рж╛рж░ ржлрж╛ржВрж╢ржи
        function startAdView() {
            if (adsWatched >= totalAds) {
                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.showAlert('ржжрзБржГржЦрж┐ржд! ржЖржЬржХрзЗрж░ ржЬржирзНржп ржЖржкржирж╛рж░ рззрзжржЯрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ред');
                } else {
                    alert('ржжрзБржГржЦрж┐ржд! ржЖржЬржХрзЗрж░ ржЬржирзНржп ржЖржкржирж╛рж░ рззрзжржЯрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ред');
                }
                return;
            }
            
            const adURL = "https://www.effectivegatecpm.com/q7m07sggj?key=0febc73b4772d20c71652935f8240078";
            
            adViewer.style.display = 'flex'; 
            adViewer.style.width = '100vw'; 
            adViewer.style.height = '100vh';
            
            adFrame.src = adURL;
            adButton.disabled = true; 

            let timeRemaining = 20; 
            countdownTimer.innerText = timeRemaining;
            adDoneButton.style.display = 'none';

            countdownInterval = setInterval(() => {
                timeRemaining--;
                countdownTimer.innerText = timeRemaining;

                if (timeRemaining <= 0) {
                    clearInterval(countdownInterval);
                    
                    rewardUser(); 
                    
                    adDoneButton.style.display = 'block'; 
                    
                    if (window.Telegram && window.Telegram.WebApp) {
                        window.Telegram.WebApp.showAlert(`рж╕ржлрж▓! ржЖржкржирж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕рзЗ ${rewardPerAd.toFixed(2)} ржЯрж╛ржХрж╛ ржпрзЛржЧ рж╣ржпрж╝рзЗржЫрзЗред ржПржЦржи 'ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ ржХрж░рзБржи' ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржиред`);
                    }
                }
            }, 1000);
        }

        // тнР ржЯрж╛ржХрж╛ ржжрзЗржУрзЯрж╛рж░ ржлрж╛ржВрж╢ржи (рж╕рзЗржн ржбрзЗржЯрж╛ ржпрзЛржЧ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ) тнР
        function rewardUser() {
            adsWatched++;
            userBalance += rewardPerAd;
            
            saveData(); // тнР ржбрзЗржЯрж╛ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи тнР
        }

        function adFinished() {
            adViewer.style.display = 'none';
            adViewer.style.width = ''; 
            adViewer.style.height = ''; 
            adFrame.src = ''; 
            updateUI(); 
            adButton.disabled = false; 
        }

        // ... (ржмрж╛ржХрж┐ ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛ ржЕржкрж░рж┐ржмрж░рзНрждрж┐ржд) ...
        function startWithdrawal() {
            // ... (ржЙржЗржержбрзНрж░ рж▓ржЬрж┐ржХ)
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                
                if (userBalance < minimumWithdrawal) {
                    tg.showAlert(`ржжрзБржГржЦрж┐ржд! ржЙржЗржержбрзНрж░ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗ ржХржоржкржХрзНрж╖рзЗ ${minimumWithdrawal.toFixed(2)} ржЯрж╛ржХрж╛ ржерж╛ржХрждрзЗ рж╣ржмрзЗред ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржмрзНржпрж╛рж▓рзЗржирзНрж╕: ${userBalance.toFixed(2)} ржЯрж╛ржХрж╛ред`);
                    return;
                }

                tg.showPopup({
                    title: 'ржЯрж╛ржХрж╛ рждрзБрж▓рзБржи',
                    message: `ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржмрзНржпрж╛рж▓рзЗржирзНрж╕: ${userBalance.toFixed(2)} ржЯрж╛ржХрж╛ред ржЖржкржирж┐ ржХржд ржЯрж╛ржХрж╛ рждрзБрж▓рждрзЗ ржЪрж╛ржи ржПржмржВ ржХрзЛржи ржкрзЗржорзЗржирзНржЯ ржкржжрзНржзрждрж┐рждрзЗ (ржмрж┐ржХрж╛рж╢/ржиржЧржж) ржЯрж╛ржХрж╛ ржирж┐рждрзЗ ржЪрж╛ржи, рждрж╛ ржирж┐ржЪрзЗрж░ ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЬрж╛ржирж╛ржиред`,
                    buttons: [
                        { text: 'ржЙржЗржержбрзНрж░ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржжрж┐ржи', id: 'request' },
                        { text: 'ржмрж╛рждрж┐рж▓ ржХрж░рзБржи', id: 'cancel', type: 'destructive' }
                    ]
                }, function(id) {
                    if (id === 'request') {
                        tg.showPopup({
                            title: 'ржкрзЗржорзЗржирзНржЯ ржкржжрзНржзрждрж┐',
                            message: 'ржЖржкржирж┐ ржмрж┐ржХрж╛рж╢ ржирж╛ ржиржЧржж, ржХрзЛржиржЯрж┐рж░ ржорж╛ржзрзНржпржорзЗ ржЯрж╛ржХрж╛ ржирж┐рждрзЗ ржЪрж╛ржи?',
                            buttons: [
                                { text: 'ржмрж┐ржХрж╛рж╢', id: 'bKash' },
                                { text: 'ржиржЧржж', id: 'Nagad' }
                            ]
                        }, function(method_id) {
                            if (method_id === 'bKash' || method_id === 'Nagad') {
                                tg.showPopup({
                                    title: `${method_id} ржиржорзНржмрж░ ржжрж┐ржи`,
                                    message: `ржЖржкржирж╛рж░ ${method_id} ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ ржиржорзНржмрж░ржЯрж┐ ржПржмржВ рждрзЛрж▓рж╛рж░ ржкрж░рж┐ржорж╛ржг рж▓рж┐ржЦрзЗ ржкрзНрж░рж╕рзНрждрзБржд ржерж╛ржХрзБржиред`,
                                    buttons: [{ text: 'ржЬржорж╛ ржжрж┐ржи', id: 'submit' }]
                                }, function(submit_id) {
                                    if (submit_id === 'submit') {
                                        // ржбрзЗржорзЛ: рж╕ржлрж▓ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржмрж╛рж░рзНрждрж╛
                                        tg.showAlert(`ржЖржкржирж╛рж░ ржЯрж╛ржХрж╛ рждрзЛрж▓рж╛рж░ ржЕржирзБрж░рзЛржз рж╕ржлрж▓ржнрж╛ржмрзЗ ржЬржорж╛ ржжрзЗржУржпрж╝рж╛ рж╣ржпрж╝рзЗржЫрзЗред рзирзк ржШржирзНржЯрж╛рж░ ржоржзрзНржпрзЗ ржЯрж╛ржХрж╛ ржкрзЗржпрж╝рзЗ ржпрж╛ржмрзЗржиред ржЖржкржирж╛рж░ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржкржжрзНржзрждрж┐: ${method_id}`);
                                        
                                        // ржЙржЗржержбрзНрж░ рж╕ржлрж▓ рж╣рж▓рзЗ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржХржорж┐ржпрж╝рзЗ рж╕рзЗржн ржХрж░рж╛ ржЙржЪрж┐ржд (ржПржЯрж┐ ржЖржкржирж╛рж░ ржмрж╛рж╕рзНрждржм рж▓ржЬрж┐ржХрзЗрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗ)
                                        // userBalance = userBalance - withdrawalAmount; 
                                        // saveData(); 
                                    }
                                });
                            }
                        });
                    }
                });
            } else {
                alert('ржЙржЗржержбрзНрж░ ржЕржкрж╢ржи рж╢рзБржзрзБржорж╛рждрзНрж░ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржорж┐ржирж┐ ржЕрзНржпрж╛ржкрзЗрж░ ржоржзрзНржпрзЗ ржХрж╛ржЬ ржХрж░рзЗред');
            }
        }
        
        function shareReferral() {
             // ... (рж░рзЗржлрж╛рж░рзЗрж▓ рж▓ржЬрж┐ржХ)
            if (window.Telegram && window.Telegram.WebApp) {
                const userId = window.Telegram.WebApp.initDataUnsafe.user ? window.Telegram.WebApp.initDataUnsafe.user.id : 'demo_user';
                const botUsername = 'your_bot_username'; 
                const referralLink = `https://t.me/${botUsername}?start=ref_${userId}`;
                
                window.Telegram.WebApp.showPopup({
                    title: 'рж░рзЗржлрж╛рж░ ржХрж░рзБржи',
                    message: `ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рзЗрж▓ рж▓рж┐ржЩрзНржХ: ${referralLink}\nрж▓рж┐ржЩрзНржХржЯрж┐ ржХржкрж┐ ржХрж░рзЗ ржмржирзНржзрзБржжрзЗрж░ рж╕рж╛ржерзЗ рж╢рзЗржпрж╝рж╛рж░ ржХрж░рзБржи!`,
                    buttons: [{ text: 'ржХржкрж┐ ржХрж░рзБржи', id: 'copy' }, { text: 'ржмржирзНржз', id: 'close' }]
                }, function(id) {
                    if (id === 'copy') {
                        navigator.clipboard.writeText(referralLink);
                        window.Telegram.WebApp.showAlert('рж▓рж┐ржЩрзНржХ ржХржкрж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ!');
                    }
                });
            } else {
                alert('ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржорзЗрж░ ржмрж╛ржЗрж░рзЗ рж░рзЗржлрж╛рж░рзЗрж▓ рж▓рж┐ржЩрзНржХ рж╢рзЗржпрж╝рж╛рж░ ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛ред');
            }
        }
    </script>
</body>
</html>
        #ad-frame {
            flex-grow: 1;
            width: 100%;
            height: 100%; /* ржмрж╛ржХрж┐ рж╕рзНржкрзЗрж╕ ржирзЗржУрзЯрж╛рж░ ржЬржирзНржп */
            border: none;
        }
        
        #ad-done-button {
            width: 90%;
            margin: 20px auto;
            padding: 15px;
            background-color: #4CAF50; 
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        #ad-done-button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="balance-card">
            <h2>ржЖржорж╛рж░ ржмрж░рзНрждржорж╛ржи ржмрзНржпрж╛рж▓рзЗржирзНрж╕:</h2>
            <p id="current-balance">рзлрзж.рзжрзж Taka ЁЯТ░</p>
        </div>

        <div class="task-grid">
            <div class="task-card" id="ad-view-card">
                <h3>ржжрзИржирж┐ржХ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛</h3>
                <p id="ad-count">0 / 10</p>
                <button id="ad-button" onclick="startAdView()">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи (рзл ржЯрж╛ржХрж╛)</button> 
            </div>

            <div class="task-card" id="referral-card">
                <h3>ржорзЛржЯ рж░рзЗржлрж╛рж░</h3>
                <p id="referral-count">0</p>
                <button onclick="shareReferral()">ржмржирзНржзрзБржжрзЗрж░ рж░рзЗржлрж╛рж░ ржХрж░рзБржи</button>
            </div>
        </div>
        
        <div class="footer-nav">
            <button onclick="startWithdrawal()">ржЯрж╛ржХрж╛ ржЙржЗржержбрзНрж░ ржХрж░рзБржи</button> 
        </div>
    </div>
    
    <div id="ad-viewer" class="ad-viewer-overlay">
        <div class="ad-header">
            ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╣ржЪрзНржЫрзЗ... (<span id="countdown-timer">20</span>s)
        </div>
        <iframe id="ad-frame" src="" frameborder="0"></iframe> 
        <button id="ad-done-button" onclick="adFinished()" style="display:none;">ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ ржХрж░рзБржи ржПржмржВ рж╣рзЛржорзЗ ржлрж┐рж░рзБржи</button>
    </div>

    <script>
        // ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬрзЗрж╢ржи
        let userBalance = 50.00;
        let adsWatched = 0;
        let totalReferrals = 0; 
        const totalAds = 10;
        const rewardPerAd = 5.00; 
        const minimumWithdrawal = 500.00; 

        let countdownInterval;
        const adViewer = document.getElementById('ad-viewer');
        const adFrame = document.getElementById('ad-frame');
        const adButton = document.getElementById('ad-button');
        const countdownTimer = document.getElementById('countdown-timer');
        const adDoneButton = document.getElementById('ad-done-button');
        const referralCountElement = document.getElementById('referral-count'); 

        // ржпржЦржи ржЕрзНржпрж╛ржк рж▓рзЛржб рж╣ржмрзЗ
        window.onload = function() {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                
                // TWA MainButton (ржирзАржЪрзЗрж░ "рж╣рзЛржо" ржмрж╛ржЯржи) рж▓рзБржХрж┐рзЯрзЗ ржлрзЗрж▓рж╛
                window.Telegram.WebApp.MainButton.hide();

                // TWA ржбрж╛рж░рзНржХ ржерж┐ржо ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛ 
                if (window.Telegram.WebApp.colorScheme === 'dark') {
                    document.body.style.backgroundColor = '#0d0d10';
                    document.body.style.color = '#f0f0f0';
                }
            }
            
            updateUI();
            showWelcomeNotice(); 
        };
        
        // UI (User Interface) ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржлрж╛ржВрж╢ржи
        function updateUI() {
            document.getElementById('current-balance').innerText = userBalance.toFixed(2) + ' Taka ЁЯТ░';
            document.getElementById('ad-count').innerText = `${adsWatched} / ${totalAds}`;
            referralCountElement.innerText = totalReferrals; 
            
            if (adsWatched >= totalAds) {
                adButton.disabled = true;
                adButton.innerText = 'ржЖржЬржХрзЗрж░ ржЯрж╛рж╕рзНржХ рж╢рзЗрж╖';
            } else {
                adButton.disabled = false;
                adButton.innerText = 'ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи (рзл ржЯрж╛ржХрж╛)';
            }
        }

        function showWelcomeNotice() {
            const noticeTitle = 'рж╕рзНржмрж╛ржЧрждржо! ЁЯФе';
            const noticeMessage = 
                'ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо, рж╕рждрждрж╛рж░ рж╕рж╛ржерзЗ ржкрзЗржорзЗржирзНржЯ ржХрж░ржЫрж┐ред ржирж┐ржпрж╝ржо ржорзЗржирзЗ ржХрж╛ржЬ ржХрж░рж▓рзЗ рззрзжрзж% ржкрзЗржорзЗржирзНржЯ ржкрж╛ржмрзЗржи ржЗржирж╢рж╛ржЖрж▓рзНрж▓рж╛рж╣! ЁЯФе\n\n' +
                'тАв ржЬржпрж╝рзЗржирж┐ржВ ржмрзЛржирж╛рж╕: рзлрзж ржЯрж╛ржХрж╛\n' +
                'тАв ржкрзНрж░рждрж┐ рж░рзЗржлрж╛рж░рзЗ: рзйрзж ржЯрж╛ржХрж╛\n' +
                'тАв ржкрзНрж░рждрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржирзЗ: рзл ржЯрж╛ржХрж╛\n' + 
                'тАв ржкрзНрж░рждрж┐ржжрж┐ржи рззрзж ржЯрж╛ ржХрж░рзЗ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛рж░ рж╕рзБржпрзЛржЧ\n' +
                '\n' +
                'тЪбя╕П ржПржЗ рж╕рж╛ржЗржЯрзЗ ржХрзЛржирзЛ ржЗржиржнрзЗрж╕рзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗ ржирж╛ рж╕ржорзНржкрзВрж░рзНржг ржлрзНрж░рж┐рждрзЗ ржЗржиржХрж╛ржо ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред ржзржирзНржпржмрж╛ржжред';
            
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.showPopup({
                    title: noticeTitle,
                    message: noticeMessage,
                    buttons: [{ text: 'ржмрзБржЭрзЗржЫрж┐', id: 'ok' }]
                });
            } else {
                alert(noticeTitle + '\n\n' + noticeMessage);
            }
        }

        // ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛рж░ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ рж╢рзБрж░рзБ ржХрж░рж╛рж░ ржлрж╛ржВрж╢ржи
        function startAdView() {
            if (adsWatched >= totalAds) {
                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.showAlert('ржжрзБржГржЦрж┐ржд! ржЖржЬржХрзЗрж░ ржЬржирзНржп ржЖржкржирж╛рж░ рззрзжржЯрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ред');
                } else {
                    alert('ржжрзБржГржЦрж┐ржд! ржЖржЬржХрзЗрж░ ржЬржирзНржп ржЖржкржирж╛рж░ рззрзжржЯрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ред');
                }
                return;
            }
            
            const adURL = "https://www.effectivegatecpm.com/q7m07sggj?key=0febc73b4772d20c71652935f8240078";
            
            adViewer.style.display = 'flex'; // ржУржнрж╛рж░рж▓рзЗ ржжрзЗржЦрж╛ржУ
            adFrame.src = adURL;
            adButton.disabled = true; 

            let timeRemaining = 20; 
            countdownTimer.innerText = timeRemaining;
            adDoneButton.style.display = 'none';

            countdownInterval = setInterval(() => {
                timeRemaining--;
                countdownTimer.innerText = timeRemaining;

                if (timeRemaining <= 0) {
                    clearInterval(countdownInterval);
                    
                    rewardUser(); 
                    
                    adDoneButton.style.display = 'block'; 
                    
                    if (window.Telegram && window.Telegram.WebApp) {
                        window.Telegram.WebApp.showAlert(`рж╕ржлрж▓! ржЖржкржирж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕рзЗ ${rewardPerAd.toFixed(2)} ржЯрж╛ржХрж╛ ржпрзЛржЧ рж╣ржпрж╝рзЗржЫрзЗред ржПржЦржи 'ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрж╛ рж╢рзЗрж╖ ржХрж░рзБржи' ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржиред`);
                    }
                }
            }, 1000);
        }

        function adFinished() {
            adViewer.style.display = 'none';
            adFrame.src = ''; 
            updateUI(); 
            adButton.disabled = false; 
        }

        function rewardUser() {
            adsWatched++;
            userBalance += rewardPerAd;
        }

        function startWithdrawal() {
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                
                if (userBalance < minimumWithdrawal) {
                    tg.showAlert(`ржжрзБржГржЦрж┐ржд! ржЙржЗржержбрзНрж░ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗ ржХржоржкржХрзНрж╖рзЗ ${minimumWithdrawal.toFixed(2)} ржЯрж╛ржХрж╛ ржерж╛ржХрждрзЗ рж╣ржмрзЗред ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржмрзНржпрж╛рж▓рзЗржирзНрж╕: ${userBalance.toFixed(2)} ржЯрж╛ржХрж╛ред`);
                    return;
                }

                tg.showPopup({
                    title: 'ржЯрж╛ржХрж╛ рждрзБрж▓рзБржи',
                    message: `ржЖржкржирж╛рж░ ржмрж░рзНрждржорж╛ржи ржмрзНржпрж╛рж▓рзЗржирзНрж╕: ${userBalance.toFixed(2)} ржЯрж╛ржХрж╛ред ржЖржкржирж┐ ржХржд ржЯрж╛ржХрж╛ рждрзБрж▓рждрзЗ ржЪрж╛ржи ржПржмржВ ржХрзЛржи ржкрзЗржорзЗржирзНржЯ ржкржжрзНржзрждрж┐рждрзЗ (ржмрж┐ржХрж╛рж╢/ржиржЧржж) ржЯрж╛ржХрж╛ ржирж┐рждрзЗ ржЪрж╛ржи, рждрж╛ ржирж┐ржЪрзЗрж░ ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЬрж╛ржирж╛ржиред`,
                    buttons: [
                        { text: 'ржЙржЗржержбрзНрж░ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржжрж┐ржи', id: 'request' },
                        { text: 'ржмрж╛рждрж┐рж▓ ржХрж░рзБржи', id: 'cancel', type: 'destructive' }
                    ]
                }, function(id) {
                    if (id === 'request') {
                        tg.showPopup({
                            title: 'ржкрзЗржорзЗржирзНржЯ ржкржжрзНржзрждрж┐',
                            message: 'ржЖржкржирж┐ ржмрж┐ржХрж╛рж╢ ржирж╛ ржиржЧржж, ржХрзЛржиржЯрж┐рж░ ржорж╛ржзрзНржпржорзЗ ржЯрж╛ржХрж╛ ржирж┐рждрзЗ ржЪрж╛ржи?',
                            buttons: [
                                { text: 'ржмрж┐ржХрж╛рж╢', id: 'bKash' },
                                { text: 'ржиржЧржж', id: 'Nagad' }
                            ]
                        }, function(method_id) {
                            if (method_id === 'bKash' || method_id === 'Nagad') {
                                tg.showPopup({
                                    title: `${method_id} ржиржорзНржмрж░ ржжрж┐ржи`,
                                    message: `ржЖржкржирж╛рж░ ${method_id} ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ ржиржорзНржмрж░ржЯрж┐ ржПржмржВ рждрзЛрж▓рж╛рж░ ржкрж░рж┐ржорж╛ржг рж▓рж┐ржЦрзЗ ржкрзНрж░рж╕рзНрждрзБржд ржерж╛ржХрзБржиред`,
                                    buttons: [{ text: 'ржЬржорж╛ ржжрж┐ржи', id: 'submit' }]
                                }, function(submit_id) {
                                    if (submit_id === 'submit') {
                                        tg.showAlert(`ржЖржкржирж╛рж░ ржЯрж╛ржХрж╛ рждрзЛрж▓рж╛рж░ ржЕржирзБрж░рзЛржз рж╕ржлрж▓ржнрж╛ржмрзЗ ржЬржорж╛ ржжрзЗржУржпрж╝рж╛ рж╣ржпрж╝рзЗржЫрзЗред рзирзк ржШржирзНржЯрж╛рж░ ржоржзрзНржпрзЗ ржЯрж╛ржХрж╛ ржкрзЗржпрж╝рзЗ ржпрж╛ржмрзЗржиред ржЖржкржирж╛рж░ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржкржжрзНржзрждрж┐: ${method_id}`);
                                    }
                                });
                            }
                        });
                    }
                });
            } else {
                alert('ржЙржЗржержбрзНрж░ ржЕржкрж╢ржи рж╢рзБржзрзБржорж╛рждрзНрж░ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржорж┐ржирж┐ ржЕрзНржпрж╛ржкрзЗрж░ ржоржзрзНржпрзЗ ржХрж╛ржЬ ржХрж░рзЗред');
            }
        }

        function shareReferral() {
            if (window.Telegram && window.Telegram.WebApp) {
                const userId = window.Telegram.WebApp.initDataUnsafe.user ? window.Telegram.WebApp.initDataUnsafe.user.id : 'demo_user';
                const botUsername = 'your_bot_username'; 
                const referralLink = `https://t.me/${botUsername}?start=ref_${userId}`;
                
                window.Telegram.WebApp.showPopup({
                    title: 'рж░рзЗржлрж╛рж░ ржХрж░рзБржи',
                    message: `ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рзЗрж▓ рж▓рж┐ржЩрзНржХ: ${referralLink}\nрж▓рж┐ржЩрзНржХржЯрж┐ ржХржкрж┐ ржХрж░рзЗ ржмржирзНржзрзБржжрзЗрж░ рж╕рж╛ржерзЗ рж╢рзЗржпрж╝рж╛рж░ ржХрж░рзБржи!`,
                    buttons: [{ text: 'ржХржкрж┐ ржХрж░рзБржи', id: 'copy' }, { text: 'ржмржирзНржз', id: 'close' }]
                }, function(id) {
                    if (id === 'copy') {
                        navigator.clipboard.writeText(referralLink);
                        window.Telegram.WebApp.showAlert('рж▓рж┐ржЩрзНржХ ржХржкрж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ!');
                    }
                });
            } else {
                alert('ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржорзЗрж░ ржмрж╛ржЗрж░рзЗ рж░рзЗржлрж╛рж░рзЗрж▓ рж▓рж┐ржЩрзНржХ рж╢рзЗржпрж╝рж╛рж░ ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛ред');
            }
        }
    </script>
</body>
</html>

